{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\antho\\\\Final_Year_Project\\\\netlens_react\\\\src\\\\components\\\\StarRating.jsx\";\nimport React, { Component } from 'react';\nimport StarRatingComponent from 'react-star-rating-component';\nimport '../style.css';\n\nvar StarRating =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(StarRating, _Component);\n\n  function StarRating() {\n    var _this;\n\n    _classCallCheck(this, StarRating);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StarRating).call(this));\n    _this.state = {\n      rating_avg: [],\n      rating_user: []\n    };\n    return _this;\n  }\n\n  _createClass(StarRating, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var res, avg, user, rating;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return fetch(\"http://127.0.0.1:8000/api/avgrate/\".concat(this.props.tmdbid));\n\n              case 3:\n                res = _context.sent;\n                _context.next = 6;\n                return res.json();\n\n              case 6:\n                avg = _context.sent;\n                _context.next = 9;\n                return fetch(\"http://127.0.0.1:8000/api/getUser/1/\".concat(this.props.tmdbid));\n\n              case 9:\n                user = _context.sent;\n\n                if (!(rating.length <= 0)) {\n                  _context.next = 14;\n                  break;\n                }\n\n                rating = [{\n                  rating: 0\n                }];\n                _context.next = 17;\n                break;\n\n              case 14:\n                _context.next = 16;\n                return user.json();\n\n              case 16:\n                rating = _context.sent;\n\n              case 17:\n                this.setState({\n                  rating_avg: avg,\n                  rating_user: rating\n                });\n                _context.next = 23;\n                break;\n\n              case 20:\n                _context.prev = 20;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0);\n\n              case 23:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 20]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"onStarClick\",\n    value: function onStarClick(nextValue, prevValue, name) {\n      this.setState({\n        rating_user: nextValue\n      });\n    }\n  }, {\n    key: \"onStarClickHalfStar\",\n    value: function () {\n      var _onStarClickHalfStar = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(nextValue, prevValue, name, e) {\n        var xPos, rate, newRating;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                xPos = (e.pageX - e.currentTarget.getBoundingClientRect().left) / e.currentTarget.offsetWidth;\n\n                if (xPos <= 0.5) {\n                  nextValue -= 0.5;\n                }\n\n                console.log('name: %s, nextValue: %s, prevValue: %s', name, nextValue, prevValue); //ADD FUNCTION TO PASS THE STAR RATING HERE\n\n                _context2.next = 5;\n                return fetch(\"http://127.0.0.1:8000/api/rate/\".concat(this.props.tmdbid, \"/1/\").concat(nextValue));\n\n              case 5:\n                rate = _context2.sent;\n                _context2.next = 8;\n                return rate.json();\n\n              case 8:\n                newRating = _context2.sent;\n                this.setState({\n                  rating_user: newRating\n                });\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function onStarClickHalfStar(_x, _x2, _x3, _x4) {\n        return _onStarClickHalfStar.apply(this, arguments);\n      }\n\n      return onStarClickHalfStar;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var rating_avg = this.state.rating_avg;\n      var rating_user = this.state.rating_user;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, rating_avg.map(function (item) {\n        return React.createElement(\"div\", {\n          style: {\n            fontSize: 24\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 62\n          },\n          __self: this\n        }, React.createElement(\"h5\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63\n          },\n          __self: this\n        }, \"Average rating: \", item.avg_rating, \" \"), React.createElement(StarRatingComponent, {\n          name: \"rating_avg\",\n          starColor: \"#ffb400\",\n          emptyStarColor: \"#ffb400\",\n          value: item.avg_rating,\n          onStarClick: _this2.onStarClickHalfStar.bind(_this2),\n          editing: false,\n          renderStarIcon: function renderStarIcon(index, value) {\n            return React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 73\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: index <= value ? 'fas fa-star' : 'far fa-star',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 74\n              },\n              __self: this\n            }));\n          },\n          renderStarIconHalf: function renderStarIconHalf() {\n            return React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 80\n              },\n              __self: this\n            }, React.createElement(\"span\", {\n              style: {\n                position: 'absolute'\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 81\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: \"far fa-star\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 81\n              },\n              __self: this\n            })), React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 82\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: \"fas fa-star-half\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 82\n              },\n              __self: this\n            })));\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }));\n      }), rating_user.map(function (item) {\n        return React.createElement(\"div\", {\n          style: {\n            fontSize: 24\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, React.createElement(\"h5\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, \"Your rating: \", item.rating), React.createElement(StarRatingComponent, {\n          name: \"rating_user\",\n          starColor: \"#ffb400\",\n          emptyStarColor: \"#ffb400\",\n          value: item.rating,\n          onStarClick: _this2.onStarClickHalfStar.bind(_this2),\n          editing: true,\n          renderStarIcon: function renderStarIcon(index, value) {\n            return React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 101\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: index <= value ? 'fas fa-star' : 'far fa-star',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 102\n              },\n              __self: this\n            }));\n          },\n          renderStarIconHalf: function renderStarIconHalf() {\n            return React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 108\n              },\n              __self: this\n            }, React.createElement(\"span\", {\n              style: {\n                position: 'absolute'\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 109\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: \"far fa-star\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 109\n              },\n              __self: this\n            })), React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 110\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: \"fas fa-star-half\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 110\n              },\n              __self: this\n            })));\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }));\n      }));\n    }\n  }]);\n\n  return StarRating;\n}(Component);\n\nexport default StarRating;","map":{"version":3,"sources":["C:\\Users\\antho\\Final_Year_Project\\netlens_react\\src\\components\\StarRating.jsx"],"names":["React","Component","StarRatingComponent","StarRating","state","rating_avg","rating_user","fetch","props","tmdbid","res","json","avg","user","rating","length","setState","console","log","nextValue","prevValue","name","e","xPos","pageX","currentTarget","getBoundingClientRect","left","offsetWidth","rate","newRating","map","item","fontSize","avg_rating","onStarClickHalfStar","bind","index","value","position"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport StarRatingComponent from 'react-star-rating-component';\r\nimport '../style.css';\r\n\r\nclass StarRating extends Component {\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            rating_avg: [],\r\n            rating_user:[],\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n      try {\r\n          const res = await fetch(`http://127.0.0.1:8000/api/avgrate/${this.props.tmdbid}`);\r\n          const avg = await res.json();\r\n\r\n          const user = await fetch(`http://127.0.0.1:8000/api/getUser/1/${this.props.tmdbid}`);\r\n          let rating;\r\n          //const userRating = await user.json();\r\n        if (rating.length <= 0){\r\n              rating = [{rating: 0}];\r\n          }\r\n          else {\r\n             rating = await user.json();\r\n          }\r\n          this.setState({\r\n              rating_avg: avg,\r\n              rating_user: rating\r\n          });\r\n      }\r\n      catch (e) {\r\n          console.log(e);\r\n      }\r\n  }\r\n\r\n    onStarClick(nextValue, prevValue, name) {\r\n        this.setState({ rating_user: nextValue });\r\n    }\r\n\r\n    async onStarClickHalfStar(nextValue, prevValue, name, e) {\r\n        const xPos = (e.pageX - e.currentTarget.getBoundingClientRect().left) / e.currentTarget.offsetWidth;\r\n\r\n        if (xPos <= 0.5) {\r\n            nextValue -= 0.5;\r\n        }\r\n\r\n        console.log('name: %s, nextValue: %s, prevValue: %s', name, nextValue, prevValue); //ADD FUNCTION TO PASS THE STAR RATING HERE\r\n        const rate = await fetch(`http://127.0.0.1:8000/api/rate/${this.props.tmdbid}/1/${nextValue}`);\r\n        const newRating = await rate.json();\r\n        this.setState({ rating_user: newRating });\r\n    }\r\n\r\n    render() {\r\n        const { rating_avg } = this.state;\r\n        const { rating_user } = this.state;\r\n        return (\r\n            <div>\r\n                {rating_avg.map(item => (\r\n                    <div style={{ fontSize: 24 }}>\r\n                        <h5>Average rating: {item.avg_rating} </h5>\r\n                        <StarRatingComponent\r\n                            name=\"rating_avg\"\r\n                            starColor=\"#ffb400\"\r\n                            emptyStarColor=\"#ffb400\"\r\n                            value={item.avg_rating}\r\n                            onStarClick={this.onStarClickHalfStar.bind(this)}\r\n                            editing={false}\r\n                            renderStarIcon={(index, value) => {\r\n                                return (\r\n                                    <span>\r\n                                    <i className={index <= value ? 'fas fa-star' : 'far fa-star'} />\r\n                                </span>\r\n                                );\r\n                            }}\r\n                            renderStarIconHalf={() => {\r\n                                return (\r\n                                    <span>\r\n                                    <span style={{ position: 'absolute' }}><i className=\"far fa-star\" /></span>\r\n                                    <span><i className=\"fas fa-star-half\" /></span>\r\n                                </span>\r\n                                );\r\n                            }} />\r\n                    </div>\r\n                ))}\r\n                {rating_user.map(item => (\r\n                    <div style={{ fontSize: 24 }}>\r\n                        <h5>Your rating: {item.rating}</h5>\r\n\r\n                        <StarRatingComponent\r\n                            name=\"rating_user\"\r\n                            starColor=\"#ffb400\"\r\n                            emptyStarColor=\"#ffb400\"\r\n                            value={item.rating}\r\n                            onStarClick={this.onStarClickHalfStar.bind(this)}\r\n                            editing={true}\r\n                            renderStarIcon={(index, value) => {\r\n                                return (\r\n                                    <span>\r\n                                    <i className={index <= value ? 'fas fa-star' : 'far fa-star'} />\r\n                                </span>\r\n                                );\r\n                            }}\r\n                            renderStarIconHalf={() => {\r\n                                return (\r\n                                    <span>\r\n                                    <span style={{ position: 'absolute' }}><i className=\"far fa-star\" /></span>\r\n                                    <span><i className=\"fas fa-star-half\" /></span>\r\n                                </span>\r\n                                );\r\n                            }} />\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default StarRating;"]},"metadata":{},"sourceType":"module"}